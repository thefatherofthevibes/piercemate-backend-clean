import{u as H,a as Q,b as K}from"./chunk-ZJRFL6ZN-DCw5YWMh.js";import{u as Y}from"./chunk-TOCMU7UV-CRqUT19D.js";import{b as x,x as U,n as J,q as X,ag as Z,e as W,dB as z,a as V,j as s,ek as ee,s as se,p as ae,h as y,u as L,eB as te,C as v,H as b,ai as re,A as j,P as B,T as N,a3 as u,db as le,r as R,es as ie,k as F,eC as oe,bL as c,L as G,B as ne,eD as ce,a0 as de,t as f,a2 as E,g as O,dh as ue,eE as me}from"./index-CU6eNUFN.js";import{u as I,_ as q}from"./chunk-DTZXEQXZ-BaBmpiQu.js";import{N as pe}from"./chunk-EMIHDNB7-OmhvQEok.js";import{u as fe}from"./chunk-IW4TACOD-CTZ6gwHz.js";import"./chunk-ZQJPHZKI-B-mOVF44.js";import{T as w}from"./chunk-GIZFNLKK-R9MsJhoe.js";import"./chunk-C76H5USB-B0JL6HGS.js";import"./chunk-MSDRGCRR-CofsaNWy.js";import"./chunk-P3UUX2T6-BbomILEi.js";import"./chunk-WG7UTTKY-BPkZ2IK1.js";import"./chunk-INE2QCSC-9vPt_CRj.js";import"./chunk-X6BAAGCL-Cmzs-01s.js";import"./chunk-DK4WIVY6-CYCbBMOO.js";import"./chunk-VT2JJ5C2-C9WnHsyg.js";import"./chunk-DFFLVEZ5-D6yYebw6.js";import"./chunk-NTEWUH4C-Zwbwn2Hl.js";import"./chunk-ADOCJB6L-Dv-zw8lO.js";import"./react-country-flag.esm-BUxefnxS.js";import"./chunk-HQKGZADC-f8IAzGhQ.js";import"./index-DA61-62J.js";import"./Trans-TuWeNclR.js";var ge=()=>{const{t:e}=x(),{regions:a}=U({limit:1e3,fields:"id,name"}),{sales_channels:t}=J({limit:1e3,fields:"id,name"});let r=[];if(a){const i={key:"region_id",label:e("fields.region"),type:"select",options:a.map(l=>({label:l.name,value:l.id})),multiple:!0,searchable:!0};r=[...r,i]}if(t){const i={key:"sales_channel_id",label:e("fields.salesChannel"),type:"select",multiple:!0,searchable:!0,options:t.map(l=>({label:l.name,value:l.id}))};r=[...r,i]}e("orders.payment.statusLabel"),e("orders.payment.status.notPaid"),e("orders.payment.status.awaiting"),e("orders.payment.status.captured"),e("orders.payment.status.refunded"),e("orders.payment.status.partiallyRefunded"),e("orders.payment.status.canceled"),e("orders.payment.status.requiresAction"),e("orders.fulfillment.statusLabel"),e("orders.fulfillment.status.notFulfilled"),e("orders.fulfillment.status.fulfilled"),e("orders.fulfillment.status.partiallyFulfilled"),e("orders.fulfillment.status.returned"),e("orders.fulfillment.status.partiallyReturned"),e("orders.fulfillment.status.shipped"),e("orders.fulfillment.status.partiallyShipped"),e("orders.fulfillment.status.canceled"),e("orders.fulfillment.status.requiresAction");const n=[{label:"Created At",key:"created_at"},{label:"Updated At",key:"updated_at"}].map(i=>({key:i.key,label:i.label,type:"date"}));return r=[...r,...n],r},Ve=e=>{const{id:a}=e.params||{},{customer:t}=z(a,void 0,{initialData:e.data,enabled:!!a});if(!t)return null;const n=[t.first_name,t.last_name].filter(Boolean).join(" ")||t.email;return s.jsx("span",{children:n})},xe=({labelKey:e,descriptionKey:a,children:t})=>s.jsx("div",{className:"flex flex-col gap-2 px-2 pb-2",children:s.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-component transition-fg hover:bg-ui-bg-component-hover active:bg-ui-bg-component-pressed group-focus-visible:shadow-borders-interactive-with-active rounded-md px-4 py-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex flex-1 flex-col",children:[s.jsx(u,{size:"small",leading:"compact",weight:"plus",children:e}),s.jsx(u,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:a})]}),s.jsx("div",{className:"flex size-7 items-center justify-center",children:t})]})})}),he=({customer:e})=>{const{t:a}=x(),t=y(),r=L(),{mutateAsync:n}=ce(e.id),i=e.addresses??[],l=async o=>{await t({title:a("general.areYouSure"),description:a("general.areYouSureDescription",{entity:a("fields.address"),title:o.address_name??"n/a"}),verificationInstruction:a("general.typeToConfirm"),verificationText:o.address_name??"address",confirmText:a("actions.delete"),cancelText:a("actions.cancel")})&&await n(o.id,{onSuccess:()=>{f.success(a("general.success",{name:o.address_name??"address"})),r(`/customers/${e.id}`,{replace:!0})},onError:m=>{f.error(m.message)}})};return s.jsxs(v,{className:"p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(b,{level:"h2",children:a("addresses.title")}),s.jsx(G,{to:"create-address",className:"text-ui-fg-muted text-xs",children:"Add"})]}),i.length===0&&s.jsx(pe,{className:de({"flex h-full flex-col overflow-hidden border-t p-6":!0}),icon:null,title:a("general.noRecordsTitle"),message:a("general.noRecordsMessage")}),i.map(o=>s.jsx(xe,{labelKey:o.address_name??"n/a",descriptionKey:[o.address_1,o.address_2].join(" "),children:s.jsx(j,{groups:[{actions:[{icon:s.jsx(N,{}),label:a("actions.delete"),onClick:async()=>{await l(o)}}]}]})},o.id))]})},ye=({customer:e})=>{const{t:a}=x(),t=y(),r=L(),{mutateAsync:n}=te(e.id),i=[e.first_name,e.last_name].filter(Boolean).join(" "),l=e.has_account?"green":"orange",o=e.has_account?a("customers.fields.registered"):a("customers.fields.guest"),g=async()=>{await t({title:a("customers.delete.title"),description:a("customers.delete.description",{email:e.email}),verificationInstruction:a("general.typeToConfirm"),verificationText:e.email,confirmText:a("actions.delete"),cancelText:a("actions.cancel")})&&await n(void 0,{onSuccess:()=>{f.success(a("customers.delete.successToast",{email:e.email})),r("/customers",{replace:!0})},onError:h=>{f.error(h.message)}})};return s.jsxs(v,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(b,{children:e.email}),s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(re,{color:l,children:o}),s.jsx(j,{groups:[{actions:[{label:a("actions.edit"),icon:s.jsx(B,{}),to:"edit"}]},{actions:[{label:a("actions.delete"),icon:s.jsx(N,{}),onClick:g}]}]})]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(u,{size:"small",leading:"compact",weight:"plus",children:a("fields.name")}),s.jsx(u,{size:"small",leading:"compact",children:i||"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(u,{size:"small",leading:"compact",weight:"plus",children:a("fields.company")}),s.jsx(u,{size:"small",leading:"compact",children:e.company_name||"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[s.jsx(u,{size:"small",leading:"compact",weight:"plus",children:a("fields.phone")}),s.jsx(u,{size:"small",leading:"compact",children:e.phone||"-"})]})]})},S=10,T="cusgr",ve=({customer:e})=>{const a=y(),[t,r]=R.useState({}),{raw:n,searchParams:i}=H({pageSize:S,prefix:T}),{customer_groups:l,count:o,isLoading:g,isError:m,error:h}=ie({...i,fields:"+customers.id",customers:{id:e.id}},{placeholderData:F}),{mutateAsync:C}=oe(e.id),_=Q(),D=je(e.id),{table:M}=I({data:l??[],columns:D,count:o,getRowId:p=>p.id,enablePagination:!0,enableRowSelection:!0,pageSize:S,prefix:T,rowSelection:{state:t,updater:r}}),$=async()=>{const p=Object.keys(t);await a({title:c("general.areYouSure"),description:c("customers.groups.removeMany",{groups:l==null?void 0:l.filter(d=>p.includes(d.id)).map(d=>d.name).join(",")}),confirmText:c("actions.remove"),cancelText:c("actions.cancel")})&&await C({remove:p},{onSuccess:()=>{f.success(c("customers.groups.removed.success",{groups:l.filter(d=>p.includes(d.id)).map(d=>d==null?void 0:d.name)}))},onError:d=>{f.error(d.message)}})};if(m)throw h;return s.jsxs(v,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(b,{level:"h2",children:c("customerGroups.domain")}),s.jsx(G,{to:`/customers/${e.id}/add-customer-groups`,children:s.jsx(ne,{variant:"secondary",size:"small",children:c("general.add")})})]}),s.jsx(q,{table:M,columns:D,pageSize:S,isLoading:g,count:o,prefix:T,navigateTo:p=>`/customer-groups/${p.id}`,filters:_,search:!0,pagination:!0,orderBy:[{key:"name",label:c("fields.name")},{key:"created_at",label:c("fields.createdAt")},{key:"updated_at",label:c("fields.updatedAt")}],commands:[{action:$,label:c("actions.remove"),shortcut:"r"}],queryObject:n,noRecords:{message:c("customers.groups.list.noRecordsMessage")}})]})},be=({group:e,customerId:a})=>{const t=y(),{t:r}=x(),{mutateAsync:n}=me(e.id),i=async()=>{await t({title:r("general.areYouSure"),description:r("customers.groups.remove",{name:e.name}),confirmText:r("actions.remove"),cancelText:r("actions.cancel")})&&await n([a],{onError:o=>{f.error(o.message)}})};return s.jsx(j,{groups:[{actions:[{label:r("actions.edit"),icon:s.jsx(B,{}),to:`/customer-groups/${e.id}/edit`},{label:r("actions.remove"),onClick:i,icon:s.jsx(N,{})}]}]})},P=O(),je=e=>{const a=K();return R.useMemo(()=>[P.display({id:"select",header:({table:t})=>s.jsx(E,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>s.jsx(E,{checked:t.getIsSelected(),onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}),...a,P.display({id:"actions",cell:({row:t})=>s.jsx(be,{group:t.original,customerId:e})})],[a,e])},A="cusord",k=10,Ce="*customer,*items,*sales_channel,payment_collections.refunded_amount,+shipping_address.country_code",_e="id,status,display_id,created_at,email,fulfillment_status,payment_status,total,currency_code",we=({customer:e})=>{const{t:a}=x(),{searchParams:t,raw:r}=fe({pageSize:k,prefix:A}),{orders:n,count:i,isLoading:l,isError:o,error:g}=le({customer_id:e.id,fields:_e+","+Ce,...t},{placeholderData:F}),m=Ae(),h=ge(),{table:C}=I({data:n??[],columns:m,enablePagination:!0,count:i,pageSize:k,prefix:A});if(o)throw g;return s.jsxs(v,{className:"divide-y p-0",children:[s.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:s.jsx(b,{level:"h2",children:a("orders.domain")})}),s.jsx(q,{columns:m,table:C,pagination:!0,navigateTo:_=>`/orders/${_.original.id}`,filters:h,count:i,isLoading:l,pageSize:k,orderBy:[{key:"display_id",label:a("orders.fields.displayId")},{key:"created_at",label:a("fields.createdAt")},{key:"updated_at",label:a("fields.updatedAt")}],search:!0,queryObject:r,prefix:A})]})},Se=({order:e})=>{const{t:a}=x();return s.jsx(j,{groups:[{actions:[{label:a("transferOwnership.label"),to:`${e.id}/transfer`,icon:s.jsx(ue,{})}]}]})},Te=O(),Ae=()=>{const e=Y({exclude:["customer"]});return R.useMemo(()=>[...e,Te.display({id:"actions",cell:({row:a})=>s.jsx(Se,{order:a.original})})],[e])},es=()=>{const{id:e}=Z(),a=W(),{customer:t,isLoading:r,isError:n,error:i}=z(e,{fields:"+*addresses"},{initialData:a}),{getWidgets:l}=V();if(r||!t)return s.jsx(ee,{sections:2,showJSON:!0,showMetadata:!0});if(n)throw i;return s.jsxs(w,{widgets:{before:l("customer.details.before"),after:l("customer.details.after"),sideAfter:l("customer.details.side.after"),sideBefore:l("customer.details.side.before")},data:t,hasOutlet:!0,showJSON:!0,showMetadata:!0,children:[s.jsxs(w.Main,{children:[s.jsx(ye,{customer:t}),s.jsx(we,{customer:t}),s.jsx(ve,{customer:t})]}),s.jsx(w.Sidebar,{children:s.jsx(he,{customer:t})})]})},ke=e=>({queryKey:ae.detail(e),queryFn:async()=>se.admin.customer.retrieve(e,{fields:"+*addresses"})}),ss=async({params:e})=>{const a=e.id,t=ke(a);return X.ensureQueryData(t)};export{Ve as Breadcrumb,es as Component,ss as loader};
