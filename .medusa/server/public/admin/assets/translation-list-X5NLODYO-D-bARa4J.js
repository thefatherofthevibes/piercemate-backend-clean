import{L as F}from"./chunk-6WKBBTKM-D3_f5owC.js";import{I as R}from"./chunk-KIIT4BNH-C4Q4cLxR.js";import{T as C}from"./chunk-GIZFNLKK-R9MsJhoe.js";import{r as x,b as N,u as B,v as D,gt as W,gu as U,j as e,ah as V,C as v,H as S,a3 as r,B as O,L as q,ak as A,I as G}from"./index-CU6eNUFN.js";import{A as J}from"./alert-BeAS6yhq.js";import"./Trans-TuWeNclR.js";var K=Object.defineProperty,w=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,P=(t,a,s)=>a in t?K(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Q=(t,a)=>{for(var s in a||(a={}))H.call(a,s)&&P(t,s,a[s]);if(w)for(var s of w(a))$.call(a,s)&&P(t,s,a[s]);return t},X=(t,a)=>{var s={};for(var n in t)H.call(t,n)&&a.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&w)for(var n of w(t))a.indexOf(n)<0&&$.call(t,n)&&(s[n]=t[n]);return s};const I=x.forwardRef((t,a)=>{var s=t,{color:n="currentColor"}=s,p=X(s,["color"]);return x.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:a},p),x.createElement("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M1.5 3.278h7.111M5.056 1.5v1.778M3.278 3.278a5.43 5.43 0 0 0 3.577 4.919"}),x.createElement("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.833 3.278C6.478 8.278 1.5 8.61 1.5 8.61M7.722 13.5l2.667-7.111h.444l2.667 7.11M8.556 11.278h4.111"}))});I.displayName="Language";var Y=({locales:t})=>{const{t:a}=N(),[s,n]=x.useState(!1),p=x.useCallback(()=>t.length<=2?t.map(u=>u.name).join(", "):`${t.slice(0,2).map(u=>u.name).join(", ")} + ${t.length-2}`,[t]),g=t.length>0;return e.jsxs(v,{className:"flex flex-col p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(S,{level:"h2",children:a("translations.activeLocales.heading")}),e.jsx(F,{variant:"interactive",className:"text-ui-fg-subtle hover:text-ui-fg-subtle-hover",to:"/settings/translations/add-locales",children:a("translations.activeLocales.noLocalesTipConfigureAction")})]}),g&&e.jsx("div",{className:"px-1 pb-1",children:e.jsx(A,{open:s,content:e.jsx("div",{className:"flex flex-col gap-y-1 p-1",children:t.map(i=>e.jsx(r,{size:"base",className:"text-ui-fg-subtle",children:i.name},i.code))}),children:e.jsxs(v,{className:"bg-ui-bg-component border-r-1 flex items-center gap-x-4 px-[19px] py-2",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[e.jsx(R,{className:"border-ui-border-base border",children:e.jsx(I,{})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(r,{size:"small",weight:"plus",children:a("translations.activeLocales.subtitle")}),e.jsx(r,{className:"text-ui-fg-subtle",size:"small",children:p()})]})]})})})]})},Z=({entities:t,hasLocales:a=!1})=>{const{t:s}=N();return e.jsx(v,{className:"divide-y p-0",children:t.map(n=>e.jsxs("div",{className:"grid grid-cols-[250px_1fr_auto] items-center gap-x-4 px-6 py-4",children:[e.jsx(r,{size:"small",weight:"plus",children:n.label}),e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:s("translations.list.metrics",{translated:(n.translatedCount??0).toLocaleString(),total:(n.totalCount??0).toLocaleString()})}),e.jsx(q,{to:`/settings/translations/edit?reference=${n.reference}`,children:e.jsx(O,{variant:"secondary",size:"small",disabled:!a||!n.totalCount,children:"Edit"})})]},n.reference))})},ee=({statistics:t,locales:a})=>{const{t:s}=N(),[n,p]=x.useState(null),{translatedCount:g,totalCount:i}=Object.values(t).reduce((l,o)=>({translatedCount:l.translatedCount+o.translated,totalCount:l.totalCount+o.expected}),{totalCount:0,translatedCount:0}),u=i>0?g/i*100:0,y=Math.max(0,i-g),m=x.useMemo(()=>{const l=new Map;return a.forEach(o=>{l.set(o.code,{translated:0,expected:0})}),Object.values(t).forEach(o=>{o.by_locale&&Object.entries(o.by_locale).forEach(([c,b])=>{const j=l.get(c);j&&(j.translated+=b.translated,j.expected+=b.expected)})}),a.map(o=>{const c=l.get(o.code)||{translated:0,expected:0};return{code:o.code,name:o.name,translated:c.translated,toTranslate:Math.max(0,c.expected-c.translated),total:c.expected}})},[t,a]),h=x.useMemo(()=>Math.max(...m.map(l=>l.total),1),[m]),f=x.useMemo(()=>m.length,[m]);return e.jsxs(v,{className:"p-0",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{level:"h2",children:s("translations.completion.heading")}),e.jsxs(r,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[g.toLocaleString()," ",s("general.of")," ",i.toLocaleString()]})]}),e.jsx("div",{className:"flex h-3 w-full overflow-hidden",children:u>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-0.5 h-full rounded-sm transition-all",style:{width:`${u}%`,backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx("div",{className:"h-full flex-1 rounded-sm",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}})]}):e.jsx("div",{className:"h-full w-full rounded-sm",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(r,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[u.toFixed(1),"%"]}),e.jsxs(r,{size:"small",weight:"plus",className:"text-ui-fg-subtle",children:[y.toLocaleString()," ",s("general.remaining").toLowerCase()]})]})]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(G,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-3 px-6 pb-6 pt-4",children:[e.jsx("div",{className:"flex h-32 w-full items-end gap-1",children:m.map(l=>{const o=l.total/h*100,c=l.total>0?l.translated/l.total*100:0;return e.jsx(A,{open:n===l.code,content:e.jsxs("div",{className:"flex min-w-[150px] flex-col gap-y-1 p-1",children:[e.jsx(r,{size:"small",weight:"plus",children:l.name}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:s("translations.completion.translated")})]}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:l.translated})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:s("translations.completion.toTranslate")})]}),e.jsx(r,{size:"small",weight:"plus",className:"text-ui-fg-base",children:l.toTranslate})]})]}),children:e.jsx("div",{className:"flex h-full flex-1 items-end justify-center",children:e.jsx("div",{className:"flex w-full min-w-2 max-w-[96px] flex-col justify-end overflow-hidden rounded-t-sm transition-opacity",style:{height:`${o}%`},onMouseEnter:()=>p(l.code),onMouseLeave:()=>p(null),children:c===0?e.jsx("div",{className:"w-full rounded-sm",style:{height:"100%",backgroundColor:"var(--tag-neutral-bg)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)"}}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full rounded-sm",style:{height:`${100-c}%`,backgroundColor:"var(--tag-blue-border)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)",minHeight:l.toTranslate>0?"2px":"0"}}),c>0&&e.jsx("div",{className:"mt-0.5 w-full rounded-sm",style:{height:`${c}%`,backgroundColor:"var(--tag-blue-icon)",boxShadow:"inset 0 0 0 0.5px var(--alpha-250)",minHeight:l.translated>0?"2px":"0"}})]})})})},l.code)})}),f<9&&e.jsx("div",{className:"flex w-full gap-1",children:m.map(l=>e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx(r,{size:"xsmall",weight:"plus",className:"text-ui-fg-subtle min-w-2 whitespace-normal break-words text-center leading-tight",children:f<6?l.name:l.code})},l.code))}),f>9&&e.jsx(r,{weight:"plus",size:"xsmall",className:"text-ui-fg-subtle text-center",children:s("translations.completion.footer")})]})]})]})},oe=()=>{var _,T,k,M;const{t}=N(),a=B(),{store:s,isPending:n,isError:p,error:g}=D(),{translatable_fields:i,isPending:u,isError:y,error:m}=W(),{statistics:h,isPending:f,isError:l,error:o}=U({locales:((_=s==null?void 0:s.supported_locales)==null?void 0:_.map(d=>d.locale_code))??[],entity_types:Object.keys(i??{})},{enabled:!!i&&!!s&&((T=s.supported_locales)==null?void 0:T.length)>0});if(p||y||l)throw g||m||o;const c=((s==null?void 0:s.supported_locales)??[]).length>0,b=x.useMemo(()=>i?Object.entries(i).filter(([d])=>!["product_option","product_option_value"].includes(d)).map(([d,L])=>{const E=(h==null?void 0:h[d])??{translated:0,expected:0};return{label:d.split("_").map(z=>z.charAt(0).toUpperCase()+z.slice(1)).join(" "),reference:d,translatableFields:L,translatedCount:E.translated,totalCount:E.expected}}).sort((d,L)=>d.label.localeCompare(L.label)):[],[i,h]),j=x.useCallback(()=>{a("/settings/translations/add-locales")},[a]);return!!s&&!n&&!u&&!!i&&(!!h&&!f||!c)?e.jsxs(C,{widgets:{before:[],after:[],sideBefore:[],sideAfter:[]},children:[e.jsxs(C.Main,{children:[e.jsxs(v,{className:"flex flex-col px-6 py-4",children:[e.jsxs(S,{children:["Manage ",t("translations.domain")]}),e.jsx(r,{className:"text-ui-fg-subtle",size:"small",children:t("translations.subtitle")})]}),!c&&e.jsx(J,{variant:"info",className:"bg-ui-bg-base flex items-center px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-x-2",children:[e.jsxs("p",{children:[t("translations.activeLocales.noLocalesTip"),"."]}),e.jsx(O,{onClick:j,size:"small",variant:"secondary",children:t("translations.activeLocales.noLocalesTipConfigureAction")})]})}),e.jsx(Z,{entities:b,hasLocales:c})]}),e.jsxs(C.Sidebar,{children:[e.jsx(Y,{locales:((k=s==null?void 0:s.supported_locales)==null?void 0:k.map(d=>d.locale))??[]}),e.jsx(ee,{statistics:h??{},locales:((M=s==null?void 0:s.supported_locales)==null?void 0:M.map(d=>d.locale))??[]})]})]}):e.jsx(V,{sidebarSections:2})};export{oe as Component};
