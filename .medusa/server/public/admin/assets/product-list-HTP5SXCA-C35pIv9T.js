import{C as w,c as A,p as E}from"./chunk-FBYTX6K7-CNg6D2YH.js";import{a as L,j as s,q as _,b as f,c as v,d as P,e as q,f as T,C as F,H as k,B as g,L as h,O as C,s as $,p as z,r as D,k as H,g as R,h as M,i as B,A as G,P as K,T as N,l as O,m as I,n as V,t as j,o as W}from"./index-CU6eNUFN.js";import{u as Y}from"./chunk-BW322BVH-DE0UiVzz.js";import{u as Z,_ as J}from"./chunk-DTZXEQXZ-BaBmpiQu.js";import{u as Q,a as U}from"./chunk-R65S6ZZV-B_GxI6mj.js";import"./chunk-ZQJPHZKI-B-mOVF44.js";import{S as X}from"./chunk-GIZFNLKK-R9MsJhoe.js";import{u as ee}from"./chunk-R4ZOO4ON-x-6ZnrFc.js";import{G as te}from"./globe-europe-DUfAVGK5.js";import"./chunk-WG7UTTKY-BPkZ2IK1.js";import"./chunk-INE2QCSC-9vPt_CRj.js";import"./chunk-X6BAAGCL-Cmzs-01s.js";import"./chunk-DK4WIVY6-CYCbBMOO.js";import"./chunk-P3UUX2T6-BbomILEi.js";import"./chunk-VT2JJ5C2-C9WnHsyg.js";import"./chunk-DFFLVEZ5-D6yYebw6.js";import"./chunk-NTEWUH4C-Zwbwn2Hl.js";import"./chunk-XLDQPLK4-D0NBFajW.js";import"./chunk-ADOCJB6L-Dv-zw8lO.js";import"./chunk-IQBAUTU5-DpWPUSGG.js";import"./chunk-KCWP7RF5-BTLBwV1W.js";import"./chunk-C76H5USB-B0JL6HGS.js";import"./react-country-flag.esm-BUxefnxS.js";import"./chunk-HQKGZADC-f8IAzGhQ.js";import"./chunk-EMIHDNB7-OmhvQEok.js";import"./index-DA61-62J.js";import"./Trans-TuWeNclR.js";var se=()=>({queryKey:z.list({limit:20,offset:0,is_giftcard:!1}),queryFn:async()=>$.admin.product.list({limit:20,offset:0,is_giftcard:!1})}),Re=e=>async()=>{const t=se();return _.getQueryData(t.queryKey)??await e.fetchQuery(t)},m=W(),ae=()=>{const{t:e}=f(),t=ee(),{product_types:a}=O({limit:1e3,offset:0}),{product_tags:o}=I({limit:1e3,offset:0}),{sales_channels:i}=V({limit:1e3,fields:"id,name"});return D.useMemo(()=>{const l=[...t];return a!=null&&a.length&&l.push(m.accessor("type_id",{label:e("fields.type"),type:"multiselect",options:a.map(r=>({label:r.value,value:r.id}))})),o!=null&&o.length&&l.push(m.accessor("tag_id",{label:e("fields.tag"),type:"multiselect",options:o.map(r=>({label:r.value,value:r.id}))})),i!=null&&i.length&&l.push(m.accessor("sales_channel_id",{label:e("fields.salesChannel"),type:"multiselect",options:i.map(r=>({label:r.name,value:r.id}))})),l.push(m.accessor("status",{label:e("fields.status"),type:"multiselect",options:[{label:e("products.productStatus.draft"),value:"draft"},{label:e("products.productStatus.proposed"),value:"proposed"},{label:e("products.productStatus.published"),value:"published"},{label:e("products.productStatus.rejected"),value:"rejected"}]})),l},[a,o,i,t,e])};function re(){return A({entity:"products",queryPrefix:"p",pageSize:20,columnAdapter:E,useData:(e,t)=>{const{products:a,count:o,isError:i,error:l,isLoading:r}=T({fields:e,...t,is_giftcard:!1},{placeholderData:(n,c)=>{var u,p;const d=(p=(u=c==null?void 0:c[c.length-1])==null?void 0:u.query)==null?void 0:p.fields;if(!(d&&d!==e))return n}});return{data:a,count:o,isLoading:r,isError:i,error:l}},getRowHref:e=>`/products/${e.id}`})}function oe(){const e=ae();return{...re(),filters:e}}var ie=()=>{const{t:e}=f(),t=v(),a=oe();return s.jsxs(s.Fragment,{children:[s.jsx(w,{adapter:a,heading:e("products.domain"),actions:[{label:e("actions.export"),to:`export${t.search}`},{label:e("actions.import"),to:`import${t.search}`},{label:e("actions.create"),to:"create"}]}),s.jsx(C,{})]})},x=20,le=()=>{const{t:e}=f(),t=v();if(P("view_configurations"))return s.jsx(ie,{});const o=q(),{searchParams:i,raw:l}=Q({pageSize:x}),{products:r,count:n,isLoading:c,isError:d,error:u}=T({...i,is_giftcard:!1},{initialData:o,placeholderData:H}),p=U(),y=de(),{table:S}=Z({data:r??[],columns:y,count:n,enablePagination:!0,pageSize:x,getRowId:b=>b.id});if(d)throw u;return s.jsxs(F,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(k,{level:"h1",children:e("products.domain")}),s.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[s.jsx(g,{size:"small",variant:"secondary",asChild:!0,children:s.jsx(h,{to:`export${t.search}`,children:e("actions.export")})}),s.jsx(g,{size:"small",variant:"secondary",asChild:!0,children:s.jsx(h,{to:`import${t.search}`,children:e("actions.import")})}),s.jsx(g,{size:"small",variant:"secondary",asChild:!0,children:s.jsx(h,{to:"create",children:e("actions.create")})})]})]}),s.jsx(J,{table:S,columns:y,count:n,pageSize:x,filters:p,search:!0,pagination:!0,isLoading:c,queryObject:l,navigateTo:b=>`${b.original.id}`,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],noRecords:{message:e("products.list.noRecordsMessage")}}),s.jsx(C,{})]})},ne=({product:e})=>{const{t}=f(),a=M(),{mutateAsync:o}=B(e.id),i=P("translation"),l=async()=>{await a({title:t("general.areYouSure"),description:t("products.deleteWarning",{title:e.title}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await o(void 0,{onSuccess:()=>{j.success(t("products.toasts.delete.success.header"),{description:t("products.toasts.delete.success.description",{title:e.title})})},onError:n=>{j.error(t("products.toasts.delete.error.header"),{description:n.message})}})};return s.jsx(G,{groups:[{actions:[{icon:s.jsx(K,{}),label:t("actions.edit"),to:`/products/${e.id}/edit`}]},...i?[{actions:[{icon:s.jsx(te,{}),label:t("translations.actions.manage"),to:`/settings/translations/edit?reference=product&reference_id=${e.id}`}]}]:[],{actions:[{icon:s.jsx(N,{}),label:t("actions.delete"),onClick:l}]}]})},ce=R(),de=()=>{const e=Y();return D.useMemo(()=>[...e,ce.display({id:"actions",cell:({row:a})=>s.jsx(ne,{product:a.original})})],[e])},Me=()=>{const{getWidgets:e}=L();return s.jsx(X,{widgets:{after:e("product.list.after"),before:e("product.list.before")},children:s.jsx(le,{})})};export{Me as Component,Re as productLoader};
