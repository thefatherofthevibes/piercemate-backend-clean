import{u as _,a as z}from"./chunk-XNIVMZHA-D7Y7TfLc.js";import{u as D,_ as N}from"./chunk-DTZXEQXZ-BaBmpiQu.js";import{K as B}from"./chunk-6HTZNHPT-CQK7Nsir.js";import{u as H,R as i}from"./chunk-D6UW7URG-Dnreh06z.js";import{b as v,f6 as M,aC as K,aD as O,r as w,f5 as U,t as y,j as e,a1 as V,B as j,ax as q,aI as G,az as Q,ak as X,a2 as b,k as Z,g as $}from"./index-CU6eNUFN.js";var J=q({locales:G(Q()).min(1)}),p=50,h="al",le=({store:r})=>{var S;const{t:o}=v(),{handleSuccess:a}=H(),{raw:t,searchParams:m}=_({pageSize:p,prefix:h}),{locales:d,count:l,isPending:C,isError:k,error:P}=M(m,{placeholderData:Z}),c=K({defaultValues:{locales:[]},resolver:O(J)}),[f,R]=w.useState({}),{setValue:A}=c,T=s=>{const u=typeof s=="function"?s(f):s,n=Object.keys(u);A("locales",n,{shouldDirty:!0,shouldTouch:!0}),R(u)},x=((S=r.supported_locales)==null?void 0:S.map(s=>s.locale_code))??[],g=Y(),{table:E}=D({data:d??[],columns:g,count:l,getRowId:s=>s.code,enableRowSelection:s=>!x.includes(s.original.code),enablePagination:!0,pageSize:p,prefix:h,rowSelection:{state:f,updater:T}}),{mutateAsync:F,isPending:I}=U(r.id),L=c.handleSubmit(async s=>{const u=Array.from(new Set([...s.locales,...x]));await F({supported_locales:u.map(n=>({locale_code:n}))},{onSuccess:()=>{y.success(o("store.toast.localesUpdated")),a()},onError:n=>{y.error(n.message)}})});if(k)throw P;return e.jsx(i.Form,{form:c,children:e.jsxs(B,{onSubmit:L,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(i.Header,{children:e.jsx("div",{className:"flex flex-1 items-center justify-between",children:e.jsx("div",{className:"flex items-center",children:c.formState.errors.locales&&e.jsx(V,{variant:"error",children:c.formState.errors.locales.message})})})}),e.jsx(i.Body,{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx(N,{table:E,pageSize:p,count:l,columns:g,layout:"fill",pagination:!0,search:"autofocus",prefix:h,orderBy:[{key:"name",label:o("fields.name")},{key:"code",label:o("fields.code")}],isLoading:C,queryObject:t})}),e.jsx(i.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(i.Close,{asChild:!0,children:e.jsx(j,{size:"small",variant:"secondary",children:o("actions.cancel")})}),e.jsx(j,{size:"small",type:"submit",isLoading:I,children:o("actions.save")})]})})]})})},W=$(),Y=()=>{const{t:r}=v(),o=z();return w.useMemo(()=>[W.display({id:"select",header:({table:a})=>e.jsx(b,{checked:a.getIsSomePageRowsSelected()?"indeterminate":a.getIsAllPageRowsSelected(),onCheckedChange:t=>a.toggleAllPageRowsSelected(!!t)}),cell:({row:a})=>{const t=!a.getCanSelect(),m=a.getIsSelected()||t,d=e.jsx(b,{checked:m,disabled:t,onCheckedChange:l=>a.toggleSelected(!!l),onClick:l=>{l.stopPropagation()}});return t?e.jsx(X,{content:r("store.localeAlreadyAdded"),side:"right",children:d}):d}}),...o],[r,o])};export{le as A};
