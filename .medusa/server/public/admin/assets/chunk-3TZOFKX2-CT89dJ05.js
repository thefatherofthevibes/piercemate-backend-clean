import{cy as p,cz as I,r as f,bI as S,k as B}from"./index-CU6eNUFN.js";var C=()=>{const[r,s]=f.useState(""),[i,t]=f.useState(""),o=f.useCallback(S(a=>t(a),300),[]);return f.useEffect(()=>(o(r),()=>o.cancel()),[r,o]),{searchValue:r,onSearchValueChange:s,query:i||void 0}},k=({queryKey:r,queryFn:s,getOptions:i,defaultValue:t,defaultValueKey:o,selectedValue:a,pageSize:x=10,enabled:c=!0})=>{const{searchValue:y,onSearchValueChange:q,query:l}=C(),E=o||"id",{data:m}=p({queryKey:[...r,t].filter(Boolean),queryFn:async()=>s({[E]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&c}),{data:d}=p({queryKey:[...r,a].filter(Boolean),queryFn:async()=>s({id:a,limit:1}),enabled:!!a&&c}),{data:h,...b}=I({queryKey:[...r,"_cbx_",l].filter(Boolean),queryFn:async({pageParam:e=0})=>await s({q:l,limit:x,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:B,enabled:c}),n=(h==null?void 0:h.pages.flatMap(e=>i(e)))??[],v=m?i(m):[],D=d?i(d):[],g=!b.isPending&&!n.length&&!y||!c;return t&&v.length&&!y&&v.forEach(e=>{n.find(u=>u.value===e.value)||n.unshift(e)}),a&&D.length&&D.forEach(e=>{n.find(u=>u.value===e.value)||n.unshift(e)}),{options:n,searchValue:y,onSearchValueChange:q,disabled:g,...b}};export{C as a,k as u};
